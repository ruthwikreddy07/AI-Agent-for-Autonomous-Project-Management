<div class="dashboard-wrapper">
  
  <aside class="sidebar">
    <div class="brand">
      <div class="logo-mark">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg>
      </div>
      <h2>PlanoraX</h2>
    </div>

    <div class="search-container">
      <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
      <input type="text" placeholder="Search">
    </div>

    <nav class="nav-links">
      <p class="section-label">NAVIGATION</p>
      
      <a class="nav-item active" (click)="onNavClick('dashboard')">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
        Overview
      </a>

      <a class="nav-item" (click)="onNavClick('tasks')">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"></path></svg>
        Tasks
      </a>

      <a class="nav-item" (click)="onNavClick('chat')">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="10" rx="2"></rect><circle cx="12" cy="5" r="2"></circle><path d="M12 7v4"></path><line x1="8" y1="16" x2="8" y2="16"></line><line x1="16" y1="16" x2="16" y2="16"></line></svg>
        AI Manager
      </a>

      <a class="nav-item" (click)="onNavClick('team')">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 00-3-3.87"></path><path d="M16 3.13a4 4 0 010 7.75"></path></svg>
        Team Space
      </a>

      <a class="nav-item" (click)="onNavClick('workflow')">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline></svg>
        Workflow
      </a>

      <a class="nav-item" (click)="onNavClick('slack')">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
        Slack Chat
      </a>

      <a class="nav-item" (click)="onNavClick('settings')">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"></path></svg>
        Settings
      </a>
    </nav>

    <div class="recent-projects">
  <p class="section-label">RECENT PROJECTS</p>
  <div class="project-item" *ngFor="let proj of stats.recent_projects; let i = index">
    <span class="dot" [ngClass]="['red', 'blue', 'pink'][i % 3]"></span> 
    {{ proj }}
  </div>
</div>
    <a class="nav-item" (click)="onNavClick('logout')" style="margin-top: auto; color: #FF754C;">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
      Logout
    </a>
  </aside>

  <main class="content-area">
    
    <header class="header">
      <div class="breadcrumbs">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#808191" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
        <span class="chevron">></span> Dashboard
      </div>
      
      <div class="header-actions">
        <div class="avatars" (click)="onNavClick('team')" style="cursor: pointer;" title="View Team Space">
  <div class="avatar-circle"><img src="https://i.pravatar.cc/150?img=32" alt="User"></div>
  <div class="avatar-circle"><img src="https://i.pravatar.cc/150?img=47" alt="User"></div>
  
  <div class="avatar-count" *ngIf="stats.total_team > 2">
    {{ stats.total_team - 2 }}+
  </div>
</div>
        
        <button class="icon-btn" (click)="onNavClick('slack')">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 01-3.46 0"></path></svg>
        </button>
        <button class="btn-primary" (click)="onNavClick('chat')">+ Add</button>
      </div> </header>

    <section class="greeting-row">
      <div>
    <h1 class="page-title">Good morning, {{ stats.user_display_name || 'Project Manager' }}!</h1>
    <p class="page-subtitle">Your AI Autonomous Agents are synced and ready to deploy.</p>
  </div>
      <div class="greeting-buttons">
        <button class="btn-outline">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polygon points="10 8 16 12 10 16 10 8"></polygon></svg>
          Start Session
        </button>
      </div>
    </section>

    <section class="stats-grid">
      <div class="stat-card">
        <div class="stat-top">
          <span class="stat-title">Active AI Agents</span>
          </div>
        <div class="stat-value">{{ stats.active }}</div>
        <div class="stat-trend positive"><span class="badge badge-purple">+15%</span> vs. last week</div>
      </div>

      <div class="stat-card">
        <div class="stat-top">
          <span class="stat-title">Tasks Due Today</span>
          </div>
        <div class="stat-value">{{ stats.tasks_due }}</div>
        <div class="stat-trend positive"><span class="badge badge-green">+10%</span> vs. last week</div>
      </div>
      
      <div class="stat-card">
        <div class="stat-top">
          <span class="stat-title">Overdue Tasks</span>
          </div>
        <div class="stat-value">{{ stats.overdue }}</div>
        <div class="stat-trend negative"><span class="badge badge-red">+18%</span> vs. last week</div>
      </div>

      <div class="stat-card">
        <div class="stat-top">
          <span class="stat-title">Completed Tasks</span>
          </div>
        <div class="stat-value">{{ stats.resolved_risks }}</div>
        <div class="stat-trend positive"><span class="badge badge-blue">+20%</span> vs. last week</div>
      </div>

    </section>

    <section class="charts-grid">
      <div class="ui-card flex-2">
        <div class="card-header">
          <div>
            <h3>Project Progress Overview</h3>
            <span class="subtitle">Track AI task completion and sprint velocity.</span>
          </div>
          
        </div>
        <div class="legend-custom">
          <span><span class="dot purple"></span> Completed</span>
          <span><span class="dot yellow"></span> Active</span>
          <span><span class="dot blue"></span> Upcoming</span>
        </div>
        <div class="chart-wrapper line-height">
          <canvas #lineCanvas></canvas>
        </div>
      </div>

      <div class="ui-card flex-1">
        <div class="card-header">
          <h3>Task Completion Stats</h3>
          <button class="btn-outline-sm" (click)="openTrello()">+ Add Task</button>
        </div>
        <div class="donut-wrapper">
          <canvas #donutCanvas></canvas>
          <div class="donut-text">
  <strong>{{ (stats.resolved_risks || 0) + (stats.in_progress || 0) + (stats.not_started || 0) }}</strong> 
  <span>Total Tasks</span>
</div>
        </div>
        
        <div class="donut-legend">
          <div class="legend-item">
            <span class="dot purple"></span> Completed 
            <span class="val">{{ stats.resolved_risks }} ({{ getPercentage(stats.resolved_risks) }})</span>
          </div>
          <div class="legend-item">
            <span class="dot blue"></span> In Progress 
            <span class="val">{{ stats.in_progress }} ({{ getPercentage(stats.in_progress) }})</span>
          </div>
          <div class="legend-item">
            <span class="dot yellow"></span> Not Started 
            <span class="val">{{ stats.not_started }} ({{ getPercentage(stats.not_started) }})</span>
          </div>
        </div>
      </div> </section> 

<section class="table-section">
  <div class="ui-card">
    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-light); padding-bottom: 15px; margin-bottom: 15px;">
      <div style="flex: 1; min-width: 0;"> 
        <h3 style="margin: 0; font-size: 18px; color: var(--text-main);">
          Budget & Resource Snapshot
        </h3>
        <span class="subtitle">Real-time spending tracked from approved plans.</span>
      </div>
      
      <div style="text-align: right; flex-shrink: 0; padding-left: 20px;">
        <div style="font-size: 24px; font-weight: 800; color: var(--brand-purple); line-height: 1;">
          {{ stats.total_budget }}
        </div>
        <div style="font-size: 10px; color: var(--text-muted); font-weight: 700; margin-top: 4px; letter-spacing: 0.5px;">
          APPROVED INVESTMENT
        </div>
      </div>
    </div>

    <div class="table-responsive">
      <table class="custom-table">
        <thead>
          <tr>
            <th>DATE</th>
            <th>CATEGORY</th>
            <th>DETAILS</th>
            <th>AMOUNT</th>
            <th>STATUS</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of financeData">
            <td class="text-muted">{{ item.date }}</td>
            <td>{{ item.category }}</td>
            <td class="font-medium">{{ item.details }}</td>
            <td [ngClass]="item.isPositive ? 'text-green' : 'text-default'">{{ item.amount }}</td>
            <td>
              <div class="status-indicator" [ngClass]="{'completed': item.status === 'Completed', 'pending': item.status === 'Active'}">
                <span class="dot-small"></span> {{ item.status }}
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>